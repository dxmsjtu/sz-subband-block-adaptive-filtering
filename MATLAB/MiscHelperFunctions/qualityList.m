%% K = 8; OversamplingRate = 2
i = 1;
filterbankSettings{1,i}.numberOfChannels = 8;
filterbankSettings{1,i}.decimationFactor = 4;
filterbankSettings{1,i}.oversamplingRate = 2;
filterbankSettings{1,i}.filterLength = 32;
filterbankSettings{1,i}.latency = 593;
filterbankSettings{1,i}.peaqScore = -2.33;
filterbankSettings{1,i}.signalToAliasRatio = 53;
filterbankSettings{1,i}.reconstructionError = -36;


i = i+1;
filterbankSettings{1,i}.numberOfChannels = 8;
filterbankSettings{1,i}.decimationFactor = 4;
filterbankSettings{1,i}.oversamplingRate = 2;
filterbankSettings{1,i}.filterLength = 48;
filterbankSettings{1,i}.latency = 609;
filterbankSettings{1,i}.peaqScore = -0.33;
filterbankSettings{1,i}.signalToAliasRatio = 71;
filterbankSettings{1,i}.reconstructionError = -59;

i = i+1;
filterbankSettings{1,i}.numberOfChannels = 8;
filterbankSettings{1,i}.decimationFactor = 4;
filterbankSettings{1,i}.oversamplingRate = 2;
filterbankSettings{1,i}.filterLength = 64;
filterbankSettings{1,i}.latency = 625;
filterbankSettings{1,i}.peaqScore = 0.01;
filterbankSettings{1,i}.signalToAliasRatio = 95;
filterbankSettings{1,i}.reconstructionError = -72;

i = i+1;
filterbankSettings{1,i}.numberOfChannels = 8;
filterbankSettings{1,i}.decimationFactor = 4;
filterbankSettings{1,i}.oversamplingRate = 2;
filterbankSettings{1,i}.filterLength = 80;
filterbankSettings{1,i}.latency = 641;
filterbankSettings{1,i}.peaqScore = 0.04;
filterbankSettings{1,i}.signalToAliasRatio = 116;
filterbankSettings{1,i}.reconstructionError = -83;

i = i+1;
filterbankSettings{1,i}.numberOfChannels = 8;
filterbankSettings{1,i}.decimationFactor = 4;
filterbankSettings{1,i}.oversamplingRate = 2;
filterbankSettings{1,i}.filterLength = 96;
filterbankSettings{1,i}.latency = 657;
filterbankSettings{1,i}.peaqScore = 0.03;
filterbankSettings{1,i}.signalToAliasRatio = 115;
filterbankSettings{1,i}.reconstructionError = -96;

i = i+1;
filterbankSettings{1,i}.numberOfChannels = 8;
filterbankSettings{1,i}.decimationFactor = 4;
filterbankSettings{1,i}.oversamplingRate = 2;
filterbankSettings{1,i}.filterLength = 112;
filterbankSettings{1,i}.latency = 673;
filterbankSettings{1,i}.peaqScore = 0.03;
filterbankSettings{1,i}.signalToAliasRatio = 132;
filterbankSettings{1,i}.reconstructionError = -106;

i = i+1;
filterbankSettings{1,i}.numberOfChannels = 8;
filterbankSettings{1,i}.decimationFactor = 4;
filterbankSettings{1,i}.oversamplingRate = 2;
filterbankSettings{1,i}.filterLength = 128;
filterbankSettings{1,i}.latency = 689;
filterbankSettings{1,i}.peaqScore = 0.04;
filterbankSettings{1,i}.signalToAliasRatio = 174;
filterbankSettings{1,i}.reconstructionError = -126;

%% K = 8; OversamplingRate = 3/2
i = 1;
filterbankSettings{2,i}.numberOfChannels = 8;
filterbankSettings{2,i}.decimationFactor = 5;
filterbankSettings{2,i}.oversamplingRate = 1.5;
filterbankSettings{2,i}.filterLength = 32;
filterbankSettings{2,i}.latency = 589;
filterbankSettings{2,i}.peaqScore = -2.04;
filterbankSettings{2,i}.signalToAliasRatio = 31;
filterbankSettings{2,i}.reconstructionError = -17;

i = i+1;
filterbankSettings{2,i}.numberOfChannels = 8;
filterbankSettings{2,i}.decimationFactor = 5;
filterbankSettings{2,i}.oversamplingRate = 1.5;
filterbankSettings{2,i}.filterLength = 48;
filterbankSettings{2,i}.latency = 605;
filterbankSettings{2,i}.peaqScore = -0.45;
filterbankSettings{2,i}.signalToAliasRatio = 50;
filterbankSettings{2,i}.reconstructionError = -40;

i = i+1;
filterbankSettings{2,i}.numberOfChannels = 8;
filterbankSettings{2,i}.decimationFactor = 5;
filterbankSettings{2,i}.oversamplingRate = 1.5;
filterbankSettings{2,i}.filterLength = 64;
filterbankSettings{2,i}.latency = 621;
filterbankSettings{2,i}.peaqScore = -0.08;
filterbankSettings{2,i}.signalToAliasRatio = 64;
filterbankSettings{2,i}.reconstructionError = -46;

i = i+1;
filterbankSettings{2,i}.numberOfChannels = 8;
filterbankSettings{2,i}.decimationFactor = 5;
filterbankSettings{2,i}.oversamplingRate = 1.5;
filterbankSettings{2,i}.filterLength = 80;
filterbankSettings{2,i}.latency = 637;
filterbankSettings{2,i}.peaqScore = 0.02;
filterbankSettings{2,i}.signalToAliasRatio = 72;
filterbankSettings{2,i}.reconstructionError = -64;

i = i+1;
filterbankSettings{2,i}.numberOfChannels = 8;
filterbankSettings{2,i}.decimationFactor = 5;
filterbankSettings{2,i}.oversamplingRate = 1.5;
filterbankSettings{2,i}.filterLength = 96;
filterbankSettings{2,i}.latency = 653;
filterbankSettings{2,i}.peaqScore = 0.03;
filterbankSettings{2,i}.signalToAliasRatio = 75;
filterbankSettings{2,i}.reconstructionError = -80;

i = i+1;
filterbankSettings{2,i}.numberOfChannels = 8;
filterbankSettings{2,i}.decimationFactor = 5;
filterbankSettings{2,i}.oversamplingRate = 1.5;
filterbankSettings{2,i}.filterLength = 112;
filterbankSettings{2,i}.latency = 669;
filterbankSettings{2,i}.peaqScore = 0.03;
filterbankSettings{2,i}.signalToAliasRatio = 92;
filterbankSettings{2,i}.reconstructionError = -85;

i = i+1;
filterbankSettings{2,i}.numberOfChannels = 8;
filterbankSettings{2,i}.decimationFactor = 5;
filterbankSettings{2,i}.oversamplingRate = 1.5;
filterbankSettings{2,i}.filterLength = 128;
filterbankSettings{2,i}.latency = 685;
filterbankSettings{2,i}.peaqScore = 0.02;
filterbankSettings{2,i}.signalToAliasRatio = 110;
filterbankSettings{2,i}.reconstructionError = -95;



%% K = 8; OversamplingRate = 5/4
i = 1;
filterbankSettings{3,i}.numberOfChannels = 8;
filterbankSettings{3,i}.decimationFactor = 6;
filterbankSettings{3,i}.oversamplingRate = 1.25;
filterbankSettings{3,i}.filterLength = 32;
filterbankSettings{3,i}.latency = 587;
filterbankSettings{3,i}.peaqScore = -3.45;
filterbankSettings{3,i}.signalToAliasRatio = 23;
filterbankSettings{3,i}.reconstructionError = -16;

i = i+1;
filterbankSettings{3,i}.numberOfChannels = 8;
filterbankSettings{3,i}.decimationFactor = 6;
filterbankSettings{3,i}.oversamplingRate = 1.25;
filterbankSettings{3,i}.filterLength = 48;
filterbankSettings{3,i}.latency = 603;
filterbankSettings{3,i}.peaqScore = -3.46;
filterbankSettings{3,i}.signalToAliasRatio = 29;
filterbankSettings{3,i}.reconstructionError = -20;

i = i+1;
filterbankSettings{3,i}.numberOfChannels = 8;
filterbankSettings{3,i}.decimationFactor = 6;
filterbankSettings{3,i}.oversamplingRate = 1.25;
filterbankSettings{3,i}.filterLength = 64;
filterbankSettings{3,i}.latency = 619;
filterbankSettings{3,i}.peaqScore = -1.86;
filterbankSettings{3,i}.signalToAliasRatio = 39;
filterbankSettings{3,i}.reconstructionError = -29;

i = i+1;
filterbankSettings{3,i}.numberOfChannels = 8;
filterbankSettings{3,i}.decimationFactor = 6;
filterbankSettings{3,i}.oversamplingRate = 1.25;
filterbankSettings{3,i}.filterLength = 80;
filterbankSettings{3,i}.latency = 635;
filterbankSettings{3,i}.peaqScore = -0.73;
filterbankSettings{3,i}.signalToAliasRatio = 50;
filterbankSettings{3,i}.reconstructionError = -41;


i = i+1;
filterbankSettings{3,i}.numberOfChannels = 8;
filterbankSettings{3,i}.decimationFactor = 6;
filterbankSettings{3,i}.oversamplingRate = 1.25;
filterbankSettings{3,i}.filterLength = 96;
filterbankSettings{3,i}.latency = 651;
filterbankSettings{3,i}.peaqScore = -0.36;
filterbankSettings{3,i}.signalToAliasRatio = 57;
filterbankSettings{3,i}.reconstructionError = -45;

i = i+1;
filterbankSettings{3,i}.numberOfChannels = 8;
filterbankSettings{3,i}.decimationFactor = 6;
filterbankSettings{3,i}.oversamplingRate = 1.25;
filterbankSettings{3,i}.filterLength = 112;
filterbankSettings{3,i}.latency = 667;
filterbankSettings{3,i}.peaqScore = -0.11;
filterbankSettings{3,i}.signalToAliasRatio = 66;
filterbankSettings{3,i}.reconstructionError = -54;

i = i+1;
filterbankSettings{3,i}.numberOfChannels = 8;
filterbankSettings{3,i}.decimationFactor = 6;
filterbankSettings{3,i}.oversamplingRate = 1.25;
filterbankSettings{3,i}.filterLength = 128;
filterbankSettings{3,i}.latency = 683;
filterbankSettings{3,i}.peaqScore = -0.02;
filterbankSettings{3,i}.signalToAliasRatio = 78;
filterbankSettings{3,i}.reconstructionError = -67;

%% Plot results
figure
for idx1 = 1:3
    tmpX = [];
    tmpY = [];
    for idx2 = 1:7
        tmpX = [tmpX; filterbankSettings{idx1,idx2}.filterLength];
        tmpY = [tmpY; filterbankSettings{idx1,idx2}.peaqScore];
    end
    plot(tmpX,tmpY)
    hold on; grid on
end
xlabel('FilterLength'); ylabel('PEAQ ODG')
legend('R = 2','R = 3/2','R = 5/4')

figure
for idx1 = 1:3
    tmpX = [];
    tmpY = [];
    for idx2 = 1:7
        tmpX = [tmpX; filterbankSettings{idx1,idx2}.filterLength];
        tmpY = [tmpY; filterbankSettings{idx1,idx2}.signalToAliasRatio];
    end
    plot(tmpX,tmpY)
    hold on; grid on
end
xlabel('FilterLength'); ylabel('SAR [dB]')
legend('R = 2','R = 3/2','R = 5/4')

figure
for idx1 = 1:3
    tmpX = [];
    tmpY = [];
    for idx2 = 1:7
        tmpX = [tmpX; filterbankSettings{idx1,idx2}.filterLength];
        tmpY = [tmpY; filterbankSettings{idx1,idx2}.reconstructionError];
    end
    plot(tmpX,tmpY)
    hold on; grid on
end
xlabel('FilterLength'); ylabel('Reconstruction err [dB]')
legend('R = 2','R = 3/2','R = 5/4')
